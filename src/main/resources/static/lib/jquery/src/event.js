define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./core/init","./data/accepts","./selector"],function(e,t,n,i,a,r){function o(){return!0}function s(){return!1}function l(){try{return document.activeElement}catch(e){}}var u=/^(?:input|select|textarea)$/i,c=/^key/,d=/^(?:mouse|pointer|contextmenu)|click/,p=/^(?:focusinfocus|focusoutblur)$/,h=/^([^.]*)(?:\.(.+)|)$/;return e.event={global:{},add:function(i,a,r,o,s){var l,u,c,d,p,f,v,g,m,y,b,_=e._data(i);if(_){for(r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=e.guid++),(u=_.events)||(u=_.events={}),(f=_.handle)||(f=_.handle=function(n){return typeof e===t||n&&e.event.triggered===n.type?void 0:e.event.dispatch.apply(f.elem,arguments)},f.elem=i),a=(a||"").match(n)||[""],c=a.length;c--;)l=h.exec(a[c])||[],m=b=l[1],y=(l[2]||"").split(".").sort(),m&&(p=e.event.special[m]||{},m=(s?p.delegateType:p.bindType)||m,p=e.event.special[m]||{},v=e.extend({type:m,origType:b,data:o,handler:r,guid:r.guid,selector:s,needsContext:s&&e.expr.match.needsContext.test(s),namespace:y.join(".")},d),(g=u[m])||(g=u[m]=[],g.delegateCount=0,p.setup&&p.setup.call(i,o,y,f)!==!1||(i.addEventListener?i.addEventListener(m,f,!1):i.attachEvent&&i.attachEvent("on"+m,f))),p.add&&(p.add.call(i,v),v.handler.guid||(v.handler.guid=r.guid)),s?g.splice(g.delegateCount++,0,v):g.push(v),e.event.global[m]=!0);i=null}},remove:function(t,i,a,r,o){var s,l,u,c,d,p,f,v,g,m,y,b=e.hasData(t)&&e._data(t);if(b&&(p=b.events)){for(i=(i||"").match(n)||[""],d=i.length;d--;)if(u=h.exec(i[d])||[],g=y=u[1],m=(u[2]||"").split(".").sort(),g){for(f=e.event.special[g]||{},g=(r?f.delegateType:f.bindType)||g,v=p[g]||[],u=u[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),c=s=v.length;s--;)l=v[s],!o&&y!==l.origType||a&&a.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(v.splice(s,1),l.selector&&v.delegateCount--,f.remove&&f.remove.call(t,l));c&&!v.length&&(f.teardown&&f.teardown.call(t,m,b.handle)!==!1||e.removeEvent(t,g,b.handle),delete p[g])}else for(g in p)e.event.remove(t,g+i[d],a,r,!0);e.isEmptyObject(p)&&(delete b.handle,e._removeData(t,"events"))}},trigger:function(t,n,a,r){var o,s,l,u,c,d,h,f=[a||document],v=i.call(t,"type")?t.type:t,g=i.call(t,"namespace")?t.namespace.split("."):[];if(l=d=a=a||document,3!==a.nodeType&&8!==a.nodeType&&!p.test(v+e.event.triggered)&&(v.indexOf(".")>=0&&(g=v.split("."),v=g.shift(),g.sort()),s=v.indexOf(":")<0&&"on"+v,t=t[e.expando]?t:new e.Event(v,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=a),n=null==n?[t]:e.makeArray(n,[t]),c=e.event.special[v]||{},r||!c.trigger||c.trigger.apply(a,n)!==!1)){if(!r&&!c.noBubble&&!e.isWindow(a)){for(u=c.delegateType||v,p.test(u+v)||(l=l.parentNode);l;l=l.parentNode)f.push(l),d=l;d===(a.ownerDocument||document)&&f.push(d.defaultView||d.parentWindow||window)}for(h=0;(l=f[h++])&&!t.isPropagationStopped();)t.type=h>1?u:c.bindType||v,o=(e._data(l,"events")||{})[t.type]&&e._data(l,"handle"),o&&o.apply(l,n),o=s&&l[s],o&&o.apply&&e.acceptData(l)&&(t.result=o.apply(l,n),t.result===!1&&t.preventDefault());if(t.type=v,!r&&!t.isDefaultPrevented()&&(!c._default||c._default.apply(f.pop(),n)===!1)&&e.acceptData(a)&&s&&a[v]&&!e.isWindow(a)){d=a[s],d&&(a[s]=null),e.event.triggered=v;try{a[v]()}catch(m){}e.event.triggered=void 0,d&&(a[s]=d)}return t.result}},dispatch:function(t){t=e.event.fix(t);var n,i,r,o,s,l=[],u=a.call(arguments),c=(e._data(this,"events")||{})[t.type]||[],d=e.event.special[t.type]||{};if(u[0]=t,t.delegateTarget=this,!d.preDispatch||d.preDispatch.call(this,t)!==!1){for(l=e.event.handlers.call(this,t,c),n=0;(o=l[n++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,s=0;(r=o.handlers[s++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,i=((e.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,u),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,t),t.result}},handlers:function(t,n){var i,a,r,o,s=[],l=n.delegateCount,u=t.target;if(l&&u.nodeType&&(!t.button||"click"!==t.type))for(;u!=this;u=u.parentNode||this)if(1===u.nodeType&&(u.disabled!==!0||"click"!==t.type)){for(r=[],o=0;l>o;o++)a=n[o],i=a.selector+" ",void 0===r[i]&&(r[i]=a.needsContext?e(i,this).index(u)>=0:e.find(i,this,null,[u]).length),r[i]&&r.push(a);r.length&&s.push({elem:u,handlers:r})}return l<n.length&&s.push({elem:this,handlers:n.slice(l)}),s},fix:function(t){if(t[e.expando])return t;var n,i,a,r=t.type,o=t,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=d.test(r)?this.mouseHooks:c.test(r)?this.keyHooks:{}),a=s.props?this.props.concat(s.props):this.props,t=new e.Event(o),n=a.length;n--;)i=a[n],t[i]=o[i];return t.target||(t.target=o.srcElement||document),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,s.filter?s.filter(t,o):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,a,r=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||document,a=i.documentElement,n=i.body,e.pageX=t.clientX+(a&&a.scrollLeft||n&&n.scrollLeft||0)-(a&&a.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(a&&a.scrollTop||n&&n.scrollTop||0)-(a&&a.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==l()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return e.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return e.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(t,n,i,a){var r=e.extend(new e.Event,i,{type:t,isSimulated:!0,originalEvent:{}});a?e.event.trigger(r,null,n):e.event.dispatch.call(n,r),r.isDefaultPrevented()&&i.preventDefault()}},e.removeEvent=document.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,n,i){var a="on"+n;e.detachEvent&&(typeof e[a]===t&&(e[a]=null),e.detachEvent(a,i))},e.Event=function(t,n){return this instanceof e.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?o:s):this.type=t,n&&e.extend(this,n),this.timeStamp=t&&t.timeStamp||e.now(),void(this[e.expando]=!0)):new e.Event(t,n)},e.Event.prototype={isDefaultPrevented:s,isPropagationStopped:s,isImmediatePropagationStopped:s,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=o,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=o,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=o,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},e.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,n){e.event.special[t]={delegateType:n,bindType:n,handle:function(t){var i,a=this,r=t.relatedTarget,o=t.handleObj;return(!r||r!==a&&!e.contains(a,r))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=n),i}}}),r.submitBubbles||(e.event.special.submit={setup:function(){return e.nodeName(this,"form")?!1:void e.event.add(this,"click._submit keypress._submit",function(t){var n=t.target,i=e.nodeName(n,"input")||e.nodeName(n,"button")?n.form:void 0;i&&!e._data(i,"submitBubbles")&&(e.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),e._data(i,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&e.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return e.nodeName(this,"form")?!1:void e.event.remove(this,"._submit")}}),r.changeBubbles||(e.event.special.change={setup:function(){return u.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(e.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),e.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),e.event.simulate("change",this,t,!0)})),!1):void e.event.add(this,"beforeactivate._change",function(t){var n=t.target;u.test(n.nodeName)&&!e._data(n,"changeBubbles")&&(e.event.add(n,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||e.event.simulate("change",this.parentNode,t,!0)}),e._data(n,"changeBubbles",!0))})},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return e.event.remove(this,"._change"),!u.test(this.nodeName)}}),r.focusinBubbles||e.each({focus:"focusin",blur:"focusout"},function(t,n){var i=function(t){e.event.simulate(n,t.target,e.event.fix(t),!0)};e.event.special[n]={setup:function(){var a=this.ownerDocument||this,r=e._data(a,n);r||a.addEventListener(t,i,!0),e._data(a,n,(r||0)+1)},teardown:function(){var a=this.ownerDocument||this,r=e._data(a,n)-1;r?e._data(a,n,r):(a.removeEventListener(t,i,!0),e._removeData(a,n))}}}),e.fn.extend({on:function(t,n,i,a,r){var o,l;if("object"==typeof t){"string"!=typeof n&&(i=i||n,n=void 0);for(o in t)this.on(o,n,i,t[o],r);return this}if(null==i&&null==a?(a=n,i=n=void 0):null==a&&("string"==typeof n?(a=i,i=void 0):(a=i,i=n,n=void 0)),a===!1)a=s;else if(!a)return this;return 1===r&&(l=a,a=function(t){return e().off(t),l.apply(this,arguments)},a.guid=l.guid||(l.guid=e.guid++)),this.each(function(){e.event.add(this,t,a,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(t,n,i){var a,r;if(t&&t.preventDefault&&t.handleObj)return a=t.handleObj,e(t.delegateTarget).off(a.namespace?a.origType+"."+a.namespace:a.origType,a.selector,a.handler),this;if("object"==typeof t){for(r in t)this.off(r,n,t[r]);return this}return(n===!1||"function"==typeof n)&&(i=n,n=void 0),i===!1&&(i=s),this.each(function(){e.event.remove(this,t,i,n)})},trigger:function(t,n){return this.each(function(){e.event.trigger(t,n,this)})},triggerHandler:function(t,n){var i=this[0];return i?e.event.trigger(t,n,i,!0):void 0}}),e});
//# sourceMappingURL=../../jquery/src/event.js.map